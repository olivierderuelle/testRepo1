node {
   stage('Compile') {
	  git url: 'https://github.com/olivierderuelle/testRepo1'
      def mvn_version = 'M3'
	  jdk = tool name: 'java8'
	  env.JAVA_HOME = "${jdk}"
      withEnv( ["PATH+MAVEN=${tool mvn_version}/bin"] ) {
		bat "echo 'jdk installation path is: ${jdk}'"
		bat "${jdk}/bin/java -version"
	    bat " mvn -f test1/pom.xml clean compile"
	  }
   }
   stage('Test') {
      def mvn_version = 'M3'
      withEnv( ["PATH+MAVEN=${tool mvn_version}/bin"] ) {
	    bat "mvn -f test1/pom.xml test"
	  }
   }
   stage('Build') {
      def mvn_version = 'M3'
      withEnv( ["PATH+MAVEN=${tool mvn_version}/bin"] ) {
	    bat "mvn -f test1/pom.xml package docker:build"
	  }
   }
}